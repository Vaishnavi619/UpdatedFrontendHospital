<app-back-button></app-back-button>

<div class="container mt-4">
  <h2 class="text-center">All Patients</h2>

  <div *ngIf="patients.length === 0 && !isSearching" class="alert alert-info">
    No patients found.
  </div>

  <div *ngIf="isSearching" class="text-center">
    <p>Searching...</p>
    </div>

  <div class="d-flex justify-content-end mb-3">
    <input
      type="text"
      class="form-control w-25"
      placeholder="ðŸ” Search patients by name..."
      [(ngModel)]="searchText"
      (input)="onSearchByName()"
    />
  </div>

  <div *ngIf="patients.length > 0" class="table-responsive">
    <table class="table table-bordered table-striped">
      <thead class="table-dark">
        <tr>
          <th>ID</th>
          <th>Full Name</th>
          <th>Age</th>
          <th>Gender</th>
          <th>Phone</th>
          <th>Address</th>
          <th>Registered Date</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let p of paginatedPatients">
          <td>{{ p.patientId }}</td>
          <td>{{ p.fullName }}</td>
          <td>{{ p.age }}</td>
          <td>{{ p.gender }}</td>
          <td>{{ p.phone }}</td>
          <td>{{ p.address }}</td>
          <td>{{ p.registeredDate }}</td>
          <td>
            <button class="btn btn-warning btn-sm me-2" (click)="onEdit(p.patientId)">Update</button>
            <button class="btn btn-danger btn-sm" (click)="onDelete(p.patientId)">Delete</button>
          </td>
        </tr>
      </tbody>
    </table>

    <nav *ngIf="patients.length > pageSize" class="mt-3">
      <ul class="pagination justify-content-center">
        <li class="page-item" [class.disabled]="page === 1">
          <button class="page-link" (click)="goToPage(page - 1)">Previous</button>
        </li>
        <li
          class="page-item"
          *ngFor="let pg of [].constructor(totalPages); let i = index"
          [class.active]="page === i + 1"
        >
          <button class="page-link" (click)="goToPage(i + 1)">{{ i + 1 }}</button>
        </li>
        <li class="page-item" [class.disabled]="page === totalPages">
          <button class="page-link" (click)="goToPage(page + 1)">Next</button>
        </li>
      </ul>
    </nav>
  </div>
</div>